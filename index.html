<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: var(--tg-theme-bg-color, #f5f5f5);
            color: var(--tg-theme-text-color, #000);
            padding: 16px;
            padding-bottom: 80px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            background: var(--tg-theme-secondary-bg-color, #fff);
            border-radius: 12px;
            padding: 4px;
        }

        .tab {
            flex: 1;
            padding: 12px;
            border: none;
            background: transparent;
            color: var(--tg-theme-text-color, #000);
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .tab.active {
            background: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #fff);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 16px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
            color: var(--tg-theme-hint-color, #999);
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--tg-theme-hint-color, #ddd);
            border-radius: 8px;
            font-size: 16px;
            background: var(--tg-theme-secondary-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
        }

        textarea {
            min-height: 80px;
            resize: vertical;
        }

        .image-upload {
            position: relative;
            border: 2px dashed var(--tg-theme-hint-color, #ddd);
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .image-upload:hover {
            border-color: var(--tg-theme-button-color, #3390ec);
            background: var(--tg-theme-secondary-bg-color, #f9f9f9);
        }

        .image-upload input {
            display: none;
        }

        .image-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            margin-top: 12px;
        }

        /* –ü—Ä–µ–≤—å—é –ø–æ—Å—Ç–∞ */
        .post-preview {
            background: var(--tg-theme-secondary-bg-color, #fff);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .post-image {
            width: 100%;
            max-height: 400px;
            object-fit: cover;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            min-height: 200px;
        }

        .post-content {
            padding: 16px;
        }

        .post-header {
            font-size: 13px;
            color: #3390ec;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .post-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .post-text {
            font-size: 14px;
            line-height: 1.5;
            color: var(--tg-theme-text-color, #000);
            white-space: pre-wrap;
        }

        .post-button {
            margin-top: 16px;
            padding: 12px;
            background: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #fff);
            border: none;
            border-radius: 8px;
            font-weight: 500;
            text-align: center;
            cursor: pointer;
        }

        .button-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 16px;
            background: var(--tg-theme-bg-color, #fff);
            border-top: 1px solid var(--tg-theme-hint-color, #ddd);
        }

        .publish-button {
            width: 100%;
            padding: 14px;
            background: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #fff);
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .publish-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .emoji {
            font-size: 20px;
        }

        .info-text {
            font-size: 12px;
            color: var(--tg-theme-hint-color, #999);
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –¢–∞–±—ã -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('editor')">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä</button>
            <button class="tab" onclick="switchTab('preview')">üëÅÔ∏è –ü—Ä–µ–≤—å—é</button>
        </div>

        <!-- –†–µ–¥–∞–∫—Ç–æ—Ä -->
        <div id="editor" class="tab-content active">
            <div class="form-group">
                <label>üèí –ö–æ–º–∞–Ω–¥–∞ 1</label>
                <input type="text" id="team1" placeholder="–ê–≤–∞–Ω–≥–∞—Ä–¥" oninput="updatePreview()">
            </div>

            <div class="form-group">
                <label>üèí –ö–æ–º–∞–Ω–¥–∞ 2</label>
                <input type="text" id="team2" placeholder="–õ–æ–∫–æ–º–æ—Ç–∏–≤" oninput="updatePreview()">
            </div>

            <div class="form-group">
                <label>üïê –í—Ä–µ–º—è –º–∞—Ç—á–∞</label>
                <input type="text" id="matchTime" placeholder="16:30 –ú–°–ö" oninput="updatePreview()">
            </div>

            <div class="form-group">
                <label>üìä –ü—Ä–æ–≥–Ω–æ–∑</label>
                <textarea id="forecast" placeholder="–ü–æ–±–µ–¥–∞ –ê–≤–∞–Ω–≥–∞—Ä–¥–∞ —Å —É—á—ë—Ç–æ–º –û–¢ –∏ –ë—É–ª–ª. –ö—Ñ: 1.87" oninput="updatePreview()"></textarea>
                <div class="info-text">–≠—Ç–æ—Ç —Ç–µ–∫—Å—Ç —É–≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏</div>
            </div>

            <div class="form-group">
                <label>üìù –û–ø–∏—Å–∞–Ω–∏–µ –º–∞—Ç—á–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                <textarea id="description" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–∞—Ç—á–∞..." oninput="updatePreview()"></textarea>
            </div>

            <div class="form-group">
                <label>üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
                <div class="image-upload" onclick="document.getElementById('imageInput').click()">
                    <div>
                        <span class="emoji">üì∑</span>
                        <p>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>
                    </div>
                    <input type="file" id="imageInput" accept="image/*" onchange="handleImageUpload(event)">
                </div>
                <img id="imagePreview" class="image-preview" style="display: none;">
            </div>
        </div>

        <!-- –ü—Ä–µ–≤—å—é -->
        <div id="preview" class="tab-content">
            <div class="post-preview">
                <div id="previewImage" class="post-image">
                    <span class="emoji">üñºÔ∏è</span>
                    <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</p>
                </div>
                <div class="post-content">
                    <div class="post-title" id="previewTitle">
                        üîª<span id="previewTeam1">–ö–æ–º–∞–Ω–¥–∞ 1</span> - <span id="previewTeam2">–ö–æ–º–∞–Ω–¥–∞ 2</span>üî∫
                    </div>
                    <div class="post-text" id="previewText"></div>
                    <div class="post-button">
                        üì± –ü–û–õ–£–ß–ò–¢–¨ –ü–†–û–ì–ù–û–ó
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="button-container">
        <button class="publish-button" onclick="publishPost()">
            üöÄ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑
        </button>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.hide();

        let uploadedImage = null;

        function switchTab(tabName) {
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');

            if (tabName === 'preview') {
                updatePreview();
            }
        }

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedImage = e.target.result;
                    document.getElementById('imagePreview').src = uploadedImage;
                    document.getElementById('imagePreview').style.display = 'block';
                    updatePreview();
                };
                reader.readAsDataURL(file);
            }
        }

        function updatePreview() {
            const team1 = document.getElementById('team1').value || '–ö–æ–º–∞–Ω–¥–∞ 1';
            const team2 = document.getElementById('team2').value || '–ö–æ–º–∞–Ω–¥–∞ 2';
            const matchTime = document.getElementById('matchTime').value || '00:00 –ú–°–ö';
            const description = document.getElementById('description').value;

            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            document.getElementById('previewTeam1').textContent = team1;
            document.getElementById('previewTeam2').textContent = team2;

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            const previewImageDiv = document.getElementById('previewImage');
            if (uploadedImage) {
                previewImageDiv.style.backgroundImage = `url(${uploadedImage})`;
                previewImageDiv.style.backgroundSize = 'cover';
                previewImageDiv.style.backgroundPosition = 'center';
                previewImageDiv.innerHTML = '';
            }

            // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞
            const date = new Date().toLocaleDateString('ru-RU', { 
                day: 'numeric', 
                month: 'long' 
            }).toUpperCase();

            let postText = `${date} | ${matchTime}\n\n`;
            
            if (description) {
                postText += `${description}\n\n`;
            } else {
                postText += `–°–µ–≥–æ–¥–Ω—è –≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ –±—É–¥—É —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–ª—è –≤–∞—Å –º–∞—Ç—á –∏–∑ –û–º—Å–∫–∞. –°—É–ø–µ—Ä –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –º–∞—Ç—á –æ–∂–∏–¥–∞–µ—Ç –Ω–∞—Å, –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥. –°–∞–º—ã–π –±–æ–ª—å—à–æ–π –≤–æ–ø—Ä–æ—Å: –ö–¢–û –ü–û–ë–ï–î–ò–¢?\n\n`;
                postText += `–Ø –¥—É–º–∞—é, —á—Ç–æ –ì–∏ –ë—É—à–µ —Å–µ—Ä—å—ë–∑–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç –ø–∞—Ä–Ω–µ–π –ø—Ä–æ—Ç–∏–≤ –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∫–∏–Ω—É–ª–∏ –∏—Ö –∏–∑ –≥–æ–Ω–∫–∏ –∑–∞ –ö—É–±–æ–∫ –ì–∞–≥–∞—Ä–∏–Ω–∞ –≤ —Ä–µ—à–∞—é—â–µ–º 7 –º–∞—Ç—á–µ —Å–µ—Ä–∏–∏. –Ø —É–≤–µ—Ä–µ–Ω, —á—Ç–æ –∏–≥—Ä–∞ –æ—á–µ–Ω—å –∑–Ω–∞—á–∏–º–∞—è –∏ –ø–æ–±–µ–¥–∞ –≤ –Ω–µ–π –ø–µ—Ä–µ–Ω–µ—Å—ë—Ç —ç–º–æ—Ü–∏–∏ –¥–∞–∂–µ –Ω–∞ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–π –ø–ª–µ–π-–æ—Ñ—Ñ.\n\n`;
                postText += `–í–æ–æ–±—â–µ –∑–∞–º–µ—Ç–∏–ª, —á—Ç–æ "${team1}" ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –Ø—Ä–æ—Å–ª–∞–≤–ª—è, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è –ø—Ä—è–º –Ω–µ—É–¥–æ–±–Ω–æ–π.\n\n`;
            }
            
            postText += `üëá –ú–æ—ë –º–Ω–µ–Ω–∏–µ –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∫–Ω–æ–ø–∫–µ –Ω–∏–∂–µ.`;

            document.getElementById('previewText').textContent = postText;
        }

        function publishPost() {
            const team1 = document.getElementById('team1').value;
            const team2 = document.getElementById('team2').value;
            const matchTime = document.getElementById('matchTime').value;
            const forecast = document.getElementById('forecast').value;
            const description = document.getElementById('description').value;

            if (!team1 || !team2 || !matchTime || !forecast) {
                tg.showAlert('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!');
                return;
            }

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
            const data = {
                team1: team1,
                team2: team2,
                time: matchTime,
                forecast: forecast,
                description: description,
                image: uploadedImage
            };

            tg.sendData(JSON.stringify(data));
            tg.close();
        }

        // –ù–∞—á–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–≤—å—é
        updatePreview();
    </script>
</body>
</html>
